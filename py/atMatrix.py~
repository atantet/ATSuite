import numpy as np
from scipy import sparse

def stochastic_matrix(csr_mat):
    N = csr_mat.shape[0]
    T = csr_mat.copy().astype(float)
    for k in range(N):
        norm = T[k].sum()
        if norm != 0:
            T.data[T.indptr[k]:T.indptr[k+1]] /= norm
    return T



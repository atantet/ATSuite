import numpy as np

def getEmbedding(ts, delays):
    '''Embed a multi-dimensional time-series'''
    delays0 = np.concatenate(([0], delays), 0)
    nDelays = len(delays0)
    (nt, dim0) = ts.shape
    dim = dim0 * nDelays
    nt = nt0 - delays0[-1]

    tsEmbed = np.zeros((nt, dim))
    for k in np.arange(dim0):
        # The original one starts from the maximum lag
        tsEmbed[k] = ts[delays0[-1]:, k] 
        for d in np.arange(1, nd):
            tsEmbed[:, dim0 * d + k] = ts[delays0[-(d+1)]:-delays0[d], k]

    return tsEmbed


